<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
      var room = window.location.href;
   function addListeners(){
      document.getElementById('text-message').addEventListener('keyup',(event)=>{
        if(event.keyCode === 13){
            sendMessage();
        }
      });
    }
      socket.emit('join room',room);
      socket.on('chat message',(msg)=>{
        var messageBox = document.createElement('div');
        messageBox.innerText= msg;
        messageBox.classList.add('receivedMessage');
        messageBox.classList.add('message');
        document.getElementById('message-container').appendChild(messageBox);
        document.getElementById('message-container').scrollTop = document.getElementById('message-container').scrollHeight;
      });
      
      function sendMessage(){
          var message = document.getElementById('text-message').value;
          if(message){
                 socket.emit('chat message', {message,room});
                 document.getElementById('text-message').value = '';
                 let messageBox = document.createElement('div');
                messageBox.innerText= message;
                messageBox.classList.add('sentMessage');
                messageBox.classList.add('message');
                document.getElementById('message-container').appendChild(messageBox);
          }else{
              window.alert("can't send empty message");
          }
      }
    </script>
    <style>
        .message{
            border-radius :10px;
            margin-bottom : 5px;
            padding:10px;
            display: table;
        }
        .receivedMessage{
            background-color:gray;
            margin-right:auto;
        }
        .sentMessage{
            background-color:dodgerblue;
            margin-left:auto;
        }
    </style>
</head>
<body onload="addListeners()" style='background:#150303'>
    <div id="message-container" style="height: 80vh;font-family:Arial, Helvetica, sans-serif;width:70%;margin: auto;font-size: 18px;padding:20px 5vw;color:white;background-color: white;border-radius: 10px;overflow-y: auto;"></div>
    <div style="width:100%;position: fixed;bottom: 5%; background-color: white;">
    <input id ='text-message' type='text' placeholder="Enter a message" style="outline:0px;padding-left:10px;width: 60%;margin-left: 15%;height: 35px;font-size:20px;border-radius: 5px;">
    <button onclick="sendMessage()" style="background-color:dodgerblue;color: white;font-size:18px;padding:10px;border:0;border-radius:6px">Send</button>
    </div>
</body>
</html>